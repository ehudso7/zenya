# OWASP ZAP Security Scan Rules for Zenya AI Platform
# God-Tier security configuration with enhanced protection

# Ignore rules that are acceptable for our application
10021	IGNORE	(Information Disclosure - Database Error Messages)
10023	IGNORE	(Information Disclosure - Debug Error Messages)
10025	IGNORE	(Information Disclosure - Directory Browsing)

# Alert on critical vulnerabilities (set to FAIL to break build)
90001	FAIL	(Insecure HTTP Method)
40003	FAIL	(CRLF Injection)
40008	FAIL	(Parameter Tampering)
40009	FAIL	(Server Side Include)
40012	FAIL	(Cross Site Scripting (Reflected))
40013	FAIL	(Session Fixation)
40014	FAIL	(Cross Site Scripting (Persistent))
40016	FAIL	(Cross Site Scripting (Persistent) - Prime)
40017	FAIL	(Cross Site Scripting (Persistent) - Spider)
40018	FAIL	(SQL Injection)
40019	FAIL	(SQL Injection - MySQL)
40020	FAIL	(SQL Injection - Hypersonic SQL)
40021	FAIL	(SQL Injection - Oracle)
40022	FAIL	(SQL Injection - PostgreSQL)
40023	FAIL	(Possible Username Enumeration)
40024	FAIL	(SQL Injection - SQLite)
40025	FAIL	(Proxy Disclosure)
40026	FAIL	(Cross Site Scripting (DOM Based))
40027	FAIL	(SQL Injection - MsSQL)
40028	FAIL	(LDAP Injection)
40029	FAIL	(XPATH Injection)
40030	FAIL	(XML External Entity Attack)
40031	FAIL	(NoSQL Injection - MongoDB)
40032	FAIL	(NoSQL Injection - ElasticSearch)
40033	FAIL	(NoSQL Injection - CouchDB)
40034	FAIL	(External Redirect)
40035	FAIL	(Heartbleed OpenSSL Vulnerability)
40036	FAIL	(Java Serialization Object)
40037	FAIL	(Remote File Inclusion)
40038	FAIL	(Format String Error)
40039	FAIL	(SOAP Action Spoofing)
40040	FAIL	(SOAP XML Injection)
40041	FAIL	(Source Code Disclosure - Git)
40042	FAIL	(Source Code Disclosure - SVN)
40043	FAIL	(Source Code Disclosure - File Inclusion)
40044	FAIL	(Anti-CSRF Tokens Check)
40045	FAIL	(Spring4Shell (CVE-2022-22965))

# Warn on medium severity issues
10020	WARN	(Anti-clickjacking Header)
10016	WARN	(Web Browser XSS Protection Not Enabled)
10017	WARN	(Cross-Domain JavaScript Source File Inclusion)
10019	WARN	(Content-Type Header Missing)
10040	WARN	(Secure Pages Include Mixed Content)
10041	WARN	(HTTP to HTTPS Insecure Transition in Form Post)
10042	WARN	(HTTPS to HTTP Insecure Transition in Form Post)
10043	WARN	(User Controllable JavaScript Event)
10045	WARN	(Source Code Disclosure - /WEB-INF folder)
10048	WARN	(Remote Code Execution - Shell Shock)
10049	WARN	(Content Cacheability)
10050	WARN	(Retrieved from Cache)
10051	WARN	(Relative Path Confusion)
10052	WARN	(X-ChromeLogger-Data Header Information Leak)
10054	WARN	(Cookie Without SameSite Attribute)
10055	WARN	(CSP)
10056	WARN	(X-Debug-Token Information Leak)
10057	WARN	(Username Hash Found)
10061	WARN	(X-AspNet-Version Response Header)
10062	WARN	(PII Disclosure)
10063	WARN	(Permissions Policy Header Not Set)
10096	WARN	(Timestamp Disclosure)
10097	WARN	(Hash Disclosure)
10098	WARN	(Cross-Domain Misconfiguration)
10099	WARN	(Source Code Disclosure)
10104	WARN	(User Agent Fuzzer)
10105	WARN	(Weak Authentication Method)
10106	WARN	(HTTP Only Site)
10107	WARN	(Httpoxy - Proxy Header Misuse)
10108	WARN	(Reverse Tabnabbing)
10109	WARN	(Modern Web Application)
10110	WARN	(Dangerous JS Functions)
10202	WARN	(Absence of Anti-CSRF Tokens)

# Info level alerts (won't fail build but useful for monitoring)
10015	INFO	(Incomplete or No Cache-control and Pragma HTTP Header Set)
10027	INFO	(Information Disclosure - Suspicious Comments)
10028	INFO	(Open Redirect)
10029	INFO	(Cookie Poisoning)
10030	INFO	(User Controllable Charset)
10031	INFO	(User Controllable HTML Element Attribute)
10032	INFO	(Viewstate)
10033	INFO	(Directory Browsing)
10034	INFO	(Heartbleed OpenSSL Vulnerability (Indicative))
10035	INFO	(Strict-Transport-Security Header)
10036	INFO	(HTTP Server Response Header)
10037	INFO	(Server Leaks Information via "X-Powered-By" HTTP Response Header Field(s))
10038	INFO	(Content Security Policy (CSP) Header Not Set)
10039	INFO	(X-Frame-Options Header)
10047	INFO	(HTTPS Content Available via HTTP)
10053	INFO	(Apache Range Header DoS (CVE-2011-3192))
10058	INFO	(Open Redirect)
10059	INFO	(PII Scanner)
10060	INFO	(Secure Pages Include Mixed Content (Including Scripts))
10094	INFO	(Base64 Disclosure)
10095	INFO	(Backup File Disclosure)
90011	INFO	(Charset Mismatch)
90020	INFO	(Application Error Disclosure)
90022	INFO	(Application Error Disclosure)
90023	INFO	(XML External Entity Attack)
90024	INFO	(Generic Padding Oracle)
90025	INFO	(Expression Language Injection)
90026	INFO	(SOAP Action Spoofing)
90027	INFO	(Cookie Slack Detector)
90028	INFO	(Insecure JSF ViewState)
90029	INFO	(SOAP XML Injection)
90030	INFO	(WSDL File Detection)
90033	INFO	(Loosely Scoped Cookie)
90034	INFO	(Cloud Metadata Potentially Exposed)

# Custom rules for Zenya AI specific security requirements
# These are hypothetical rule IDs for demonstration
99001	FAIL	(API Key Exposure in Response)
99002	FAIL	(Supabase Credential Leak)
99003	WARN	(AI Provider Rate Limit Bypass Attempt)
99004	WARN	(Unauthorized Learning Data Access)
99005	INFO	(Performance Metrics Exposure)